/**
 * HazardIdentifierAgent Prompt Template (Phase 3a: T118)
 *
 * Few-shot prompt for Claude 3.5 Sonnet to predict relevant hazard codes
 * based on job description, equipment, and workspace.
 */

import { PromptTemplate } from '@langchain/core/prompts';

export const HAZARD_IDENTIFIER_SYSTEM_PROMPT = `Ти си експерт за безбедност и здравље на раду у Србији.

Твој задатак је да анализираш описе радних места и предложиш релевантне шифре опасности према српским BZR прописима (Закон о безбедности и здрављу на раду).

ВАЖНО:
- Анализирај описане услове рада
- Предложи 3-7 најрелевантнијих шифара опасности
- За сваку шифру дај разлог зашто је релевантна
- Буди конзервативан - боље више шифара него премало
- Користи само шифре из доступне листе (не измишљај нове!)`;

export const FEW_SHOT_EXAMPLES = `
ПРИМЕР 1:
Позиција: Програмер
Опис посла: Пише код, ради са рачунаром 8 сати дневно, учествује у team meetings
Опрема: Компјутер, 2 монитора, тастатура, миш
Радни простор: Канцеларија, затворен простор
Радно време: 8 сати дневно, понекад прековремено

→ ПРЕДЛОЖЕНЕ ОПАСНОСТИ:
[
  {
    "hazardCode": "29",
    "confidence": 0.95,
    "rationale": "Програмер ради 8 сати дневно за рачунаром са 2 монитора. Изложеност екранима >4h/дневно је висок ризик - обавезне су паузе и прегледи вида."
  },
  {
    "hazardCode": "33",
    "confidence": 0.90,
    "rationale": "Дуготрајно седење (8h дневно) у канцеларији. Нефизиолошки положај тела може довести до проблема са кичмом, болова у леђима и лоше циркулације."
  },
  {
    "hazardCode": "34",
    "confidence": 0.75,
    "rationale": "Рад са роковима (deadline-и), понекад прековремени рад. Можлива изложеност стресу због пројектних захтева и очекивања."
  },
  {
    "hazardCode": "32",
    "confidence": 0.60,
    "rationale": "Рад на рачунару може бити монотон (понављање истих задатака, code review, bug fixing). Умерен ризик."
  }
]

---

ПРИМЕР 2:
Позиција: Виљушкариста
Опис посла: Управља виљушкаром у магацину, преноси терет, утоварује камионе
Опрема: Виљушкар (електрични), палетне дизалице
Радни простор: Магацин са високим полицама
Радно време: 8 сати дневно, повремено смене

→ ПРЕДЛОЖЕНЕ ОПАСНОСТИ:
[
  {
    "hazardCode": "06",
    "confidence": 0.98,
    "rationale": "Управљање виљушкаром у унутрашњем саобраћају магацина је директна изложеност возилима. Високи ризик судара, повреда пешака, несрећа са теретом."
  },
  {
    "hazardCode": "01",
    "confidence": 0.90,
    "rationale": "Преношење терета и рад са високим полицама ствара ризик од пада предмета. Терет може бити нестабилан, палете оштећене."
  },
  {
    "hazardCode": "22",
    "confidence": 0.80,
    "rationale": "Виљушкар производи вибрације које се преносе на тело возача током 8-часовне смене. Могуће оштећење кичме и зглобова."
  },
  {
    "hazardCode": "21",
    "confidence": 0.70,
    "rationale": "Магацин са виљушкарима и утоварним операцијама генерише буку (мотори, аларми, удари палета). Могућа изложеност буци >85 dB."
  },
  {
    "hazardCode": "10",
    "confidence": 0.65,
    "rationale": "Магацинске површине могу бити неравне, могуће проливене течности или препреке. Ризик од клизања и спотицања."
  }
]

---

ПРИМЕР 3:
Позиција: Извршни директор
Опис посла: Руководи компанијом, доноси стратешке одлуке, учествује у састанцима са клијентима
Опрема: Лаптоп, мобилни телефон
Радни простор: Канцеларија + повремени теренски састанци
Радно време: 8-10 сати дневно, викенди по потреби

→ ПРЕДЛОЖЕНЕ ОПАСНОСТИ:
[
  {
    "hazardCode": "29",
    "confidence": 0.90,
    "rationale": "Рад са лаптопом и телефоном више од 8 сати дневно. Константна изложеност екранима захтева паузе и ергономску поставку радног места."
  },
  {
    "hazardCode": "33",
    "confidence": 0.85,
    "rationale": "Дуготрајно седење на састанцима и рад за рачунаром (8-10h). Недостатак физичке активности, ризик по кичму."
  },
  {
    "hazardCode": "34",
    "confidence": 0.95,
    "rationale": "Руковођење компанијом је стресна позиција - одговорност за пословне резултате, одлуке које утичу на запослене, финансијски притисак."
  },
  {
    "hazardCode": "35",
    "confidence": 0.88,
    "rationale": "Извршни директор има највишу одговорност у преносу информација и доношењу стратешких одлука. Грешке могу имати велике последице."
  },
  {
    "hazardCode": "36",
    "confidence": 0.75,
    "rationale": "Рад 8-10 сати дневно плус викенди по потреби представља прековремени рад. Лоша организација рада може довести до burnout-а."
  }
]

---
`;

export const HAZARD_IDENTIFIER_PROMPT = PromptTemplate.fromTemplate(`
${HAZARD_IDENTIFIER_SYSTEM_PROMPT}

ДОСТУПНЕ ШИФРЕ ОПАСНОСТИ (укупно 40):
{hazardCodesList}

---

ПРИМЕРИ АНАЛИЗЕ:
{fewShotExamples}

---

САДА АНАЛИЗИРАЈ СЛЕДЕЋУ ПОЗИЦИЈУ:

Позиција: {positionName}
Опис посла: {jobDescription}
Опрема: {equipment}
Радни простор: {workspace}
Радно време: {workHours}

ПОВРАТАК У JSON ФОРМАТУ:
{formatInstructions}

ВАЖНО: Користи само шифре које постоје у горњој листи. Confidence је број 0-1 (1 = сигурно примењује се).
`);
